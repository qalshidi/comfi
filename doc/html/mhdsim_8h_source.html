<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>2.5D MHD Simulation for the Solar Chromosphere: mhdsim.h Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">2.5D MHD Simulation for the Solar Chromosphere
   &#160;<span id="projectnumber">0</span>
   </div>
   <div id="projectbrief">2.5D MHD Simulation for the Solar Chromosphere</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">mhdsim.h</div>  </div>
</div><!--header-->
<div class="contents">
<a href="mhdsim_8h.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#pragma once</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment">// IMPORTANT: Must be set prior to any ViennaCL includes if you want to use ViennaCL algorithms on Armadillo objects</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#define VIENNACL_WITH_ARMADILLO</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment">// std includes</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;iostream&gt;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;fstream&gt;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;cmath&gt;</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment">// external libraries</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;armadillo&gt;</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &quot;viennacl/vector.hpp&quot;</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &quot;viennacl/matrix.hpp&quot;</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &quot;viennacl/compressed_matrix.hpp&quot;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="preprocessor">#include &quot;viennacl/linalg/prod.hpp&quot;</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &quot;viennacl/linalg/gmres.hpp&quot;</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#include &quot;viennacl/linalg/bicgstab.hpp&quot;</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#include &quot;viennacl/linalg/ilu.hpp&quot;</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;viennacl/linalg/lu.hpp&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#include &quot;viennacl/linalg/sum.hpp&quot;</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="preprocessor">#include &quot;viennacl/linalg/maxmin.hpp&quot;</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &quot;viennacl/tools/random.hpp&quot;</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="preprocessor">#include &quot;viennacl/linalg/inner_prod.hpp&quot;</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;viennacl/tools/timer.hpp&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;viennacl/forwards.h&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno"><a class="line" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">   31</a></span>&#160;<span class="keyword">typedef</span> viennacl::vector&lt;double&gt; <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a>; </div><div class="line"><a name="l00032"></a><span class="lineno"><a class="line" href="mhdsim_8h.html#ae4ee75f4477664e9b5f6d7adf50015fc">   32</a></span>&#160;<span class="keyword">typedef</span> viennacl::compressed_matrix&lt;double&gt; <a class="code" href="mhdsim_8h.html#ae4ee75f4477664e9b5f6d7adf50015fc">vcl_sp_mat</a>; </div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">// local includes</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="params_8h.html">params.h</a>&quot;</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="types_8h.html">types.h</a>&quot;</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="preprocessor">#include &quot;fluxl.h&quot;</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="operators_8h.html">operators.h</a>&quot;</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespacemhdsim.html">mhdsim</a></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;{</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00046"></a><span class="lineno"><a class="line" href="namespacemhdsim_1_1util.html">   46</a></span>&#160;<span class="keyword">namespace </span>util</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="namespacemhdsim_1_1util.html#af15dfd00ae1dd641e0e97636d34a94e0">gettimestr</a>();</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="keywordtype">void</span> <a class="code" href="namespacemhdsim_1_1util.html#a25e8e6e7a98b09a14b457c6a71195662">sendtolog</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> message, <span class="keyword">const</span> <span class="keywordtype">string</span> filename);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;arma::vec <a class="code" href="namespacemhdsim_1_1util.html#ac0faca5852f97a731ba13bbfcde6c700">fillInitialCondition</a>(<span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1BgData.html">mhdsim::types::BgData</a> &amp;ctx);</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemhdsim_1_1util.html#adca8d76103a8130a98778505cc46577a">sanityCheck</a>(<a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;xn, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op);</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;<span class="comment">// Misc</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment"></span><span class="keyword">const</span> arma::sp_mat  <a class="code" href="namespacemhdsim_1_1util.html#a30e36126d85f589d94afbfc7c69aad58">syncSpMat</a>(<span class="keyword">const</span> arma::umat Avi, <span class="keyword">const</span> arma::umat Avj, <span class="keyword">const</span> arma::mat Avv, <span class="keyword">const</span> uint num_of_rows =num_of_elem, <span class="keyword">const</span> uint num_of_cols =num_of_elem);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span>        <a class="code" href="namespacemhdsim_1_1util.html#a44d1518893fe4440d99dd12faba13896">getmaxV</a>(<span class="keyword">const</span> arma::vec &amp;x0);</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span>        <a class="code" href="namespacemhdsim_1_1util.html#a44d1518893fe4440d99dd12faba13896">getmaxV</a>(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;x0, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;<span class="keyword">const</span> <span class="keywordtype">bool</span>          <a class="code" href="namespacemhdsim_1_1util.html#aaf35ba0b0056a7b173316bb14770cdd6">saveSolution</a>(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;x0, <span class="keyword">const</span> <span class="keywordtype">int</span> &amp;timestep, <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op);</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span>        <a class="code" href="namespacemhdsim_1_1util.html#a8ed5efd8d0c977c20a2d3c9b2b79c987">getsumBE</a>(<span class="keyword">const</span> arma::vec &amp;x0);</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span>        <a class="code" href="namespacemhdsim_1_1util.html#a53616aa3ed8024e292629c183817ebc3">getsumKE</a>(<span class="keyword">const</span> arma::vec &amp;x0);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;<span class="keyword">const</span> <span class="keywordtype">double</span>        <a class="code" href="namespacemhdsim_1_1util.html#a9b0597e97dbb6e72532124a07974edaa">getsumUE</a>(<span class="keyword">const</span> arma::vec &amp;x0);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemhdsim_1_1util.html#a7ab1ff58e201df428e29d7d44be4e7c3">saveField</a>(<span class="keyword">const</span> arma::vec &amp;x0, <span class="keyword">const</span> <span class="keywordtype">string</span> name, <span class="keyword">const</span> <span class="keywordtype">int</span> timestep);</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemhdsim_1_1util.html#a2342bc1d05f7a0a0bb1858332020313c">saveScalar</a>(<span class="keyword">const</span> arma::vec &amp;x0, <span class="keyword">const</span> <span class="keywordtype">string</span> name, <span class="keyword">const</span> <span class="keywordtype">int</span> timestep);</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemhdsim_1_1util.html#a7ab1ff58e201df428e29d7d44be4e7c3">saveField</a>(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;x0, <span class="keyword">const</span> <span class="keywordtype">string</span> name, <span class="keyword">const</span> <span class="keywordtype">int</span> timestep);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="namespacemhdsim_1_1util.html#a2342bc1d05f7a0a0bb1858332020313c">saveScalar</a>(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;x0, <span class="keyword">const</span> <span class="keywordtype">string</span> name, <span class="keyword">const</span> <span class="keywordtype">int</span> timestep);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> <a class="code" href="namespacemhdsim_1_1util.html#a40c8eba798de2d8d43e6fc727e964b8a">getCxMax</a>(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;xn, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op);</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> <a class="code" href="namespacemhdsim_1_1util.html#a57204ac80e2a1442edd6f669d9765e73">getCzMax</a>(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;xn, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op);</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment">//void                trackVariables(cube &amp;track, const arma::vec &amp;x0, const mhdsim::types::BgData &amp;ctx, const uint time_step);</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;} <span class="comment">// namespace util</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="keyword">namespace </span>routines</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;{</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> cross_prod(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;f1, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;f2, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op);</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> dot_prod(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;f1, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;f2, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op);</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> computeRHS_Euler(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;xn, <span class="keyword">const</span> <span class="keywordtype">double</span> dt, <span class="keyword">const</span> <span class="keywordtype">double</span> t, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1BgData.html">mhdsim::types::BgData</a> &amp;bg);</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> computeRHS_RK4(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;xn, <span class="keyword">const</span> <span class="keywordtype">double</span> dt, <span class="keyword">const</span> <span class="keywordtype">double</span> t, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1BgData.html">mhdsim::types::BgData</a> &amp;bg);</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> computeRHS_BDF2(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;xn, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;xn1, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#ae4ee75f4477664e9b5f6d7adf50015fc">vcl_sp_mat</a> &amp;Ri, <span class="keyword">const</span> <span class="keywordtype">double</span> alpha, <span class="keyword">const</span> <span class="keywordtype">double</span> beta, <span class="keyword">const</span> <span class="keywordtype">double</span> dt, <span class="keyword">const</span> <span class="keywordtype">double</span> t, <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1BgData.html">mhdsim::types::BgData</a> &amp;bg);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;<span class="keyword">const</span> arma::sp_mat  computeRi (<span class="keyword">const</span> arma::vec &amp;xn, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;<span class="keywordtype">void</span> bottomBC(<a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Lxn, <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Rxn, <span class="keyword">const</span> <span class="keywordtype">double</span> t, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1BgData.html">mhdsim::types::BgData</a> &amp;bg);</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> Fx(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;xn,<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Npij, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op);</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> Fz(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;xn,<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Npij, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> Re_MUSCL(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;xn, <span class="keyword">const</span> <span class="keywordtype">double</span> t, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1BgData.html">mhdsim::types::BgData</a> &amp;bg);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;<span class="comment">// inlines</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> grad_tvd(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;s_iph,</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;s_imh,</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;s_jph,</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;s_jmh,</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;            <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;{</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> xpart = (s_iph-s_imh)/dx;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> zpart = (s_jph-s_jmh)/dz;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <span class="keywordflow">return</span> viennacl::linalg::prod(op.<a class="code" href="structmhdsim_1_1types_1_1Operators.html#ac86bcac20ed3f26fb5979bb57941a981">s2xf</a>,xpart) + viennacl::linalg::prod(op.<a class="code" href="structmhdsim_1_1types_1_1Operators.html#aabf65ef94598cbd0e9a8cdc0be6f179c">s2zf</a>,zpart);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;}</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> div_tvd(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;s_iph, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;s_imh, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;s_jph, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;s_jmh, <span class="keyword">const</span> <a class="code" href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a> &amp;op)</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;{</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;  <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> xpart = (s_iph-s_imh)/dx;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> zpart = (s_jph-s_jmh)/dz;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keywordflow">return</span> xpart+zpart;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;}</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;} <span class="comment">// namespace routines</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno"><a class="line" href="namespacemhdsim_1_1sol.html">  308</a></span>&#160;<span class="keyword">namespace </span>sol</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;{</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> nu_in(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;nn, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;T)</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  <span class="keywordflow">return</span> (7.4e-11 * nn * (<a class="code" href="params_8h.html#a41d3c8210c66503aba558f60096aa156">n_0</a>*1.e-6) * sqrt(std::abs(T*T_0)) * <a class="code" href="params_8h.html#a385bed8284591a787a17855a77788de4">t_0</a>); <span class="comment">// ion-neutral collision rate</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;}</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> nu_en(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;nn, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;T)</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="keywordflow">return</span> (1.95e-10 * nn * (<a class="code" href="params_8h.html#a41d3c8210c66503aba558f60096aa156">n_0</a>*1.e-6) * sqrt(std::abs(T*T_0)) * <a class="code" href="params_8h.html#a385bed8284591a787a17855a77788de4">t_0</a>); <span class="comment">// electron-neutral collision rate</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> nu_ei(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;ne, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;T)</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;{</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> lambda = 10.0; <span class="comment">// coloumb logarithm</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <span class="keywordflow">return</span> (lambda * 3.759e-6 * ne * (<a class="code" href="params_8h.html#a41d3c8210c66503aba558f60096aa156">n_0</a>*1.e-6) * std::pow(std::abs(T*T_0),-1.5) * <a class="code" href="params_8h.html#a385bed8284591a787a17855a77788de4">t_0</a>); <span class="comment">// electron-ion collision rate</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;}</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> nu_in(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;nn, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;T)</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;{</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">return</span> 7.4e-11 * (<a class="code" href="params_8h.html#a41d3c8210c66503aba558f60096aa156">n_0</a>*1.e-6)* <a class="code" href="params_8h.html#a385bed8284591a787a17855a77788de4">t_0</a>  * viennacl::linalg::element_prod(nn, viennacl::linalg::element_sqrt(T*T_0)); <span class="comment">// ion-neutral collision rate</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;}</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> nu_en(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;nn, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;T)</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;{</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keywordflow">return</span> 1.95e-10 * (<a class="code" href="params_8h.html#a41d3c8210c66503aba558f60096aa156">n_0</a>*1.e-6)* <a class="code" href="params_8h.html#a385bed8284591a787a17855a77788de4">t_0</a> * viennacl::linalg::element_prod(nn, viennacl::linalg::element_sqrt(T*T_0)); <span class="comment">// electron-neutral collision rate</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;}</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> nu_ei(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;ne, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Te)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">double</span> lambda = 10.0; <span class="comment">// coloumb logarithm</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <span class="keywordflow">return</span> lambda * (<a class="code" href="params_8h.html#a41d3c8210c66503aba558f60096aa156">n_0</a>*1.e-6) * <a class="code" href="params_8h.html#a385bed8284591a787a17855a77788de4">t_0</a>* 3.759e-6 * viennacl::linalg::element_prod(ne,viennacl::linalg::element_exp(-1.5*viennacl::linalg::element_log(T_0*Te))); <span class="comment">// electron-ion collision rate</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;}</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> nu_ii(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Np, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Tp)</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;{</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="params_8h.html#a385bed8284591a787a17855a77788de4">t_0</a> * 0.9e-6 * viennacl::linalg::element_prod(Np*<a class="code" href="params_8h.html#a41d3c8210c66503aba558f60096aa156">n_0</a>, viennacl::linalg::element_exp(-1.5*viennacl::linalg::element_log(T_0*Tp))); <span class="comment">// electron-ion collision rate</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> nu_ii(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Np, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Tp)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;{</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <span class="keywordflow">return</span> <a class="code" href="params_8h.html#a385bed8284591a787a17855a77788de4">t_0</a> * 0.9e-6 * Np*<a class="code" href="params_8h.html#a41d3c8210c66503aba558f60096aa156">n_0</a> * std::exp(-1.5*std::log(T_0*Tp)); <span class="comment">// electron-ion collision rate</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;}</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> resistivity(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Np, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Nn, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Tp, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Tn)</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;{</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="params_8h.html#af913577defdcc179f5db61d8bd22a1e8">m_e</a>/(q*q))*viennacl::linalg::element_div((nu_ei(Np,Tp)+nu_en(Nn,0.5*(Tp+Tn))),Np);</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;}</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> resistivity(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Np, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Nn, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Tp, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Tn)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;{</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <span class="keywordflow">return</span> (<a class="code" href="params_8h.html#af913577defdcc179f5db61d8bd22a1e8">m_e</a>/(q*q)) * (nu_ei(Np,Tp)+nu_en(Nn,0.5*(Tp+Tn)))/Np;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;}</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> kappa_n(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Tn)</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;{</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="keywordflow">return</span> 3.79e-3 * viennacl::linalg::element_exp(0.69*viennacl::linalg::element_log(Tn*T_0)) / kappa_0;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;}</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> kappa_n(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Tn, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Nn)</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;{</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="keywordflow">return</span> std::exp(-1.0/Nn) * 3.79e-3 * std::exp(0.69*std::log(Tn*T_0)) / kappa_0;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;}</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> kappa_p(<span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Tp, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Tn, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Np, <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> &amp;Nn)</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;{</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="keyword">using namespace </span><a class="code" href="namespaceviennacl_1_1linalg.html">viennacl::linalg</a>;</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keyword">const</span> <a class="code" href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a> one = viennacl::scalar_vector&lt;double&gt;(Np.size(),1.0);</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="keywordflow">return</span> 1.6021766e-17 * 3.1e4 * element_prod(element_exp(-1.0*element_log((one+1.25*(element_div(nu_in(Nn,0.5*(Tp+Tn)),nu_ii(Np,Tp)))*((3.0+1.0+8.0/5.0)/4.0+1.5)))) , element_exp(2.5*element_log(Tp*T_0))) / kappa_0;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;}</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="keyword">inline</span> <span class="keyword">const</span> <span class="keywordtype">double</span> kappa_p(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Tp, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Tn, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Np, <span class="keyword">const</span> <span class="keywordtype">double</span> &amp;Nn)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;{</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  <span class="keywordflow">return</span> std::exp(-1.0/Np) * 1.6021766e-17 * 3.1e4 * std::exp(-1.0*std::log((1.0+1.25*(nu_in(Nn,0.5*(Tp+Tn))/nu_ii(Np,Tp))*((3.0+1.0+8.0/5.0)/4.0+1.5)))) * std::exp(2.5*std::log(Tp*T_0)) / kappa_0;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;} <span class="comment">// namespace sol</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;} <span class="comment">// namespace mhdsim</span></div><div class="ttc" id="types_8h_html"><div class="ttname"><a href="types_8h.html">types.h</a></div><div class="ttdoc">All data types are found here. </div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_adca8d76103a8130a98778505cc46577a"><div class="ttname"><a href="namespacemhdsim_1_1util.html#adca8d76103a8130a98778505cc46577a">mhdsim::util::sanityCheck</a></div><div class="ttdeci">const bool sanityCheck(vcl_vec &amp;xn, const mhdsim::types::Operators &amp;op)</div><div class="ttdoc">Check in temperatures are negative (sane is all positive) </div><div class="ttdef"><b>Definition:</b> util.cpp:396</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_a8ed5efd8d0c977c20a2d3c9b2b79c987"><div class="ttname"><a href="namespacemhdsim_1_1util.html#a8ed5efd8d0c977c20a2d3c9b2b79c987">mhdsim::util::getsumBE</a></div><div class="ttdeci">const double getsumBE(const arma::vec &amp;x0)</div><div class="ttdoc">Calculate the magnetic field energy density sum of all grid cells. </div><div class="ttdef"><b>Definition:</b> util.cpp:241</div></div>
<div class="ttc" id="mhdsim_8h_html_ae4ee75f4477664e9b5f6d7adf50015fc"><div class="ttname"><a href="mhdsim_8h.html#ae4ee75f4477664e9b5f6d7adf50015fc">vcl_sp_mat</a></div><div class="ttdeci">viennacl::compressed_matrix&lt; double &gt; vcl_sp_mat</div><div class="ttdoc">GPU sparse matrix with ViennaCL. </div><div class="ttdef"><b>Definition:</b> mhdsim.h:32</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_ac0faca5852f97a731ba13bbfcde6c700"><div class="ttname"><a href="namespacemhdsim_1_1util.html#ac0faca5852f97a731ba13bbfcde6c700">mhdsim::util::fillInitialCondition</a></div><div class="ttdeci">arma::vec fillInitialCondition(const mhdsim::types::BgData &amp;ctx)</div><div class="ttdoc">fillInitialCondition fills a mhdsim::types::BgData with the initial condition </div><div class="ttdef"><b>Definition:</b> util.cpp:22</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_a2342bc1d05f7a0a0bb1858332020313c"><div class="ttname"><a href="namespacemhdsim_1_1util.html#a2342bc1d05f7a0a0bb1858332020313c">mhdsim::util::saveScalar</a></div><div class="ttdeci">const bool saveScalar(const arma::vec &amp;x0, const string name, const int timestep)</div><div class="ttdoc">saveScalar Write a binary file of a scalar arma::vector. </div></div>
<div class="ttc" id="structmhdsim_1_1types_1_1Operators_html"><div class="ttname"><a href="structmhdsim_1_1types_1_1Operators.html">mhdsim::types::Operators</a></div><div class="ttdoc">Data structure with sparse matrices that act like operators. </div><div class="ttdef"><b>Definition:</b> types.h:50</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_a30e36126d85f589d94afbfc7c69aad58"><div class="ttname"><a href="namespacemhdsim_1_1util.html#a30e36126d85f589d94afbfc7c69aad58">mhdsim::util::syncSpMat</a></div><div class="ttdeci">const arma::sp_mat syncSpMat(const arma::umat Avi, const arma::umat Avj, const arma::mat Avv, const uint num_of_rows=num_of_elem, const uint num_of_cols=num_of_elem)</div><div class="ttdoc">Creates a sparse matrix after async parallel construction of i,j,val components. </div><div class="ttdef"><b>Definition:</b> util.cpp:5</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_a40c8eba798de2d8d43e6fc727e964b8a"><div class="ttname"><a href="namespacemhdsim_1_1util.html#a40c8eba798de2d8d43e6fc727e964b8a">mhdsim::util::getCxMax</a></div><div class="ttdeci">const vcl_vec getCxMax(const vcl_vec &amp;xn, const mhdsim::types::Operators &amp;op)</div><div class="ttdoc">getCxMax Get horizontal fast mode speed </div><div class="ttdef"><b>Definition:</b> util.cpp:155</div></div>
<div class="ttc" id="params_8h_html_a41d3c8210c66503aba558f60096aa156"><div class="ttname"><a href="params_8h.html#a41d3c8210c66503aba558f60096aa156">n_0</a></div><div class="ttdeci">const double n_0</div><div class="ttdoc">m-3 density at z=0 </div><div class="ttdef"><b>Definition:</b> params.h:36</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_a9b0597e97dbb6e72532124a07974edaa"><div class="ttname"><a href="namespacemhdsim_1_1util.html#a9b0597e97dbb6e72532124a07974edaa">mhdsim::util::getsumUE</a></div><div class="ttdeci">const double getsumUE(const arma::vec &amp;x0)</div><div class="ttdoc">Calculate the sum of the thermal energy density of all grid cells. </div><div class="ttdef"><b>Definition:</b> util.cpp:289</div></div>
<div class="ttc" id="params_8h_html"><div class="ttname"><a href="params_8h.html">params.h</a></div><div class="ttdoc">Parameters are editable here (such as grid size) </div></div>
<div class="ttc" id="structmhdsim_1_1types_1_1Operators_html_aabf65ef94598cbd0e9a8cdc0be6f179c"><div class="ttname"><a href="structmhdsim_1_1types_1_1Operators.html#aabf65ef94598cbd0e9a8cdc0be6f179c">mhdsim::types::Operators::s2zf</a></div><div class="ttdeci">vcl_sp_mat s2zf</div><div class="ttdoc">Sparse matrix to multiply scalar vector to field vector with the scalar value for all components...</div><div class="ttdef"><b>Definition:</b> types.h:113</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_a7ab1ff58e201df428e29d7d44be4e7c3"><div class="ttname"><a href="namespacemhdsim_1_1util.html#a7ab1ff58e201df428e29d7d44be4e7c3">mhdsim::util::saveField</a></div><div class="ttdeci">const bool saveField(const arma::vec &amp;x0, const string name, const int timestep)</div><div class="ttdoc">Write a binary file of a field arma::vector. </div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_aaf35ba0b0056a7b173316bb14770cdd6"><div class="ttname"><a href="namespacemhdsim_1_1util.html#aaf35ba0b0056a7b173316bb14770cdd6">mhdsim::util::saveSolution</a></div><div class="ttdeci">const bool saveSolution(const vcl_vec &amp;x0, const int &amp;timestep, mhdsim::types::Operators &amp;op)</div><div class="ttdoc">saveSolution Save solution into seperate binary files for each unknown. </div><div class="ttdef"><b>Definition:</b> util.cpp:309</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_af15dfd00ae1dd641e0e97636d34a94e0"><div class="ttname"><a href="namespacemhdsim_1_1util.html#af15dfd00ae1dd641e0e97636d34a94e0">mhdsim::util::gettimestr</a></div><div class="ttdeci">const string gettimestr()</div><div class="ttdoc">gettimestr Get current time. </div><div class="ttdef"><b>Definition:</b> util.cpp:49</div></div>
<div class="ttc" id="operators_8h_html"><div class="ttname"><a href="operators_8h.html">operators.h</a></div><div class="ttdoc">Operator building. </div></div>
<div class="ttc" id="params_8h_html_a385bed8284591a787a17855a77788de4"><div class="ttname"><a href="params_8h.html#a385bed8284591a787a17855a77788de4">t_0</a></div><div class="ttdeci">const double t_0</div><div class="ttdoc">in s </div><div class="ttdef"><b>Definition:</b> params.h:51</div></div>
<div class="ttc" id="namespacemhdsim_html"><div class="ttname"><a href="namespacemhdsim.html">mhdsim</a></div><div class="ttdef"><b>Definition:</b> mhdsim.h:40</div></div>
<div class="ttc" id="namespaceviennacl_1_1linalg_html"><div class="ttname"><a href="namespaceviennacl_1_1linalg.html">linalg</a></div></div>
<div class="ttc" id="params_8h_html_af913577defdcc179f5db61d8bd22a1e8"><div class="ttname"><a href="params_8h.html#af913577defdcc179f5db61d8bd22a1e8">m_e</a></div><div class="ttdeci">const double m_e</div><div class="ttdoc">mass of electron in kg </div><div class="ttdef"><b>Definition:</b> params.h:44</div></div>
<div class="ttc" id="structmhdsim_1_1types_1_1BgData_html"><div class="ttname"><a href="structmhdsim_1_1types_1_1BgData.html">mhdsim::types::BgData</a></div><div class="ttdoc">Background Data is stored here. </div><div class="ttdef"><b>Definition:</b> types.h:31</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_a53616aa3ed8024e292629c183817ebc3"><div class="ttname"><a href="namespacemhdsim_1_1util.html#a53616aa3ed8024e292629c183817ebc3">mhdsim::util::getsumKE</a></div><div class="ttdeci">const double getsumKE(const arma::vec &amp;x0)</div><div class="ttdoc">Calculate the sum of the kinetic energy of all grid cells. </div><div class="ttdef"><b>Definition:</b> util.cpp:263</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_a57204ac80e2a1442edd6f669d9765e73"><div class="ttname"><a href="namespacemhdsim_1_1util.html#a57204ac80e2a1442edd6f669d9765e73">mhdsim::util::getCzMax</a></div><div class="ttdeci">const vcl_vec getCzMax(const vcl_vec &amp;xn, const mhdsim::types::Operators &amp;op)</div><div class="ttdoc">getCzMax Get vertical fast mode speed </div><div class="ttdef"><b>Definition:</b> util.cpp:202</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_a25e8e6e7a98b09a14b457c6a71195662"><div class="ttname"><a href="namespacemhdsim_1_1util.html#a25e8e6e7a98b09a14b457c6a71195662">mhdsim::util::sendtolog</a></div><div class="ttdeci">void sendtolog(const string message, const string filename)</div><div class="ttdoc">sendtolog Send message to log file. </div></div>
<div class="ttc" id="structmhdsim_1_1types_1_1Operators_html_ac86bcac20ed3f26fb5979bb57941a981"><div class="ttname"><a href="structmhdsim_1_1types_1_1Operators.html#ac86bcac20ed3f26fb5979bb57941a981">mhdsim::types::Operators::s2xf</a></div><div class="ttdeci">vcl_sp_mat s2xf</div><div class="ttdoc">Sparse matrix to multiply scalar vector to field vector with the scalar value for all components...</div><div class="ttdef"><b>Definition:</b> types.h:113</div></div>
<div class="ttc" id="namespacemhdsim_1_1util_html_a44d1518893fe4440d99dd12faba13896"><div class="ttname"><a href="namespacemhdsim_1_1util.html#a44d1518893fe4440d99dd12faba13896">mhdsim::util::getmaxV</a></div><div class="ttdeci">const double getmaxV(const arma::vec &amp;x0)</div><div class="ttdoc">getmaxV get fast mode speed + local speed OR resistivity speed whichever is faster ...</div><div class="ttdef"><b>Definition:</b> util.cpp:100</div></div>
<div class="ttc" id="mhdsim_8h_html_a6642d3613bf26ca9c62ab358018c0201"><div class="ttname"><a href="mhdsim_8h.html#a6642d3613bf26ca9c62ab358018c0201">vcl_vec</a></div><div class="ttdeci">viennacl::vector&lt; double &gt; vcl_vec</div><div class="ttdoc">GPU arma::vector with ViennaCL. </div><div class="ttdef"><b>Definition:</b> mhdsim.h:31</div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
